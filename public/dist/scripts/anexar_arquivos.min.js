let removerArquivos,tamanhoArquivos=0;var anexos=function(e,anexo,funcao){var method1,method2;"inserir"===funcao?(method1="add",method2="remove",info=`anexado o arquivo: ${e.target.value.split("\\")[2]}`):(e.preventDefault(),method1="remove",method2="add",info=""),document.querySelector(`#label-${anexo}`).classList[method1]("remover-arquivo"),document.querySelector(`.texto-${anexo}`).innerHTML=info,document.querySelector(`#label-${anexo} i`).classList[method2]("fa-upload"),document.querySelector(`#label-${anexo} i`).classList[method1]("fa-times"),document.querySelector(`#label-${anexo} i`).classList[method1](`remover-${anexo}`)};const isImage=e=>{const ext=e.target.value.split(".").pop();return"jpg"===ext||"jpeg"===ext||"png"===ext};var inputAnexosListener=e=>{let idArquivo=e.target.id.split("-")[e.target.id.split("-").length-1];const isImg=isImage(e),tipoAnexo=validarImagens(e);document.querySelector(`#label-anexo-${idArquivo} i`).classList.contains("fa-upload")&&e.target.files[0].size<1048576&&tamanhoArquivos+e.target.files[0].size<5242880?"imagem"===tipoAnexo&&isImg||"imagem"!==tipoAnexo?(tamanhoArquivos+=e.target.files[0].size,anexos(e,`anexo-${idArquivo}`,"inserir"),console.log("aumentou tamanho: ",tamanhoArquivos),document.getElementById(`tipo-arquivo-${idArquivo}`).classList.add("readonly")):"imagem"!==tipoAnexo||isImg||(variaveisGlobais.exibirMensagem("<h3>As imagens devem estar codificadas nos formatos JPEG ou PNG</h3>",3500),e.target.value=""):e.target.files[0]&&(e.target.files[0].size>1048576||tamanhoArquivos+e.target.files[0].size>5242880)&&isImg&&(variaveisGlobais.exibirMensagem("Cada arquivo deve ter tamanho inferior a 1MB e o total de arquivos anexados não pode ultrapassar 5MB",3500),console.log("ultrapassou tamanho! Tamanho geral dos arquivos: >>>> ",tamanhoArquivos),e.target.value="")},removerAnexosListener=e=>{""!==document.getElementById(`anexo-${e.target.dataset.ref.split("-")[e.target.dataset.ref.split("-").length-1]}`).value&&(tamanhoArquivos-=document.getElementById(`anexo-${e.target.dataset.ref.split("-")[e.target.dataset.ref.split("-").length-1]}`).files[0].size,console.log("diminuiu tamanho: ",tamanhoArquivos))},removerArquivosListener=e=>{if(e.target.classList.contains("remover-arquivo")){let idArquivo=e.target.id.split("-")[e.target.id.split("-").length-1];tamanhoArquivos-=document.getElementById(`anexo-${idArquivo}`).files[0].size,document.getElementById(`anexo-${idArquivo}`).value="",document.getElementById(`tipo-arquivo-${idArquivo}`).classList.remove("readonly"),e.preventDefault(),anexos(e,`anexo-${idArquivo}`,"remover"),console.log("diminuiu tamanho: ",tamanhoArquivos)}};let controlarExibicaoCamposImagem=id=>{let disposicao=document.getElementById(`disposicao-imagem-${id}`);document.getElementById("radio6")&&!document.getElementById("radio6").checked?(disposicao.classList.remove("hidden"),disposicao.previousElementSibling.classList.remove("hidden")):(disposicao.classList.add("hidden"),disposicao.previousElementSibling.classList.add("hidden"))},definirNomeImagem=(e,id)=>{let nomeDoConteudo,nomeDoArquivo=document.getElementById(`nome-imagem-${id}`);nomeDoConteudo=document.querySelector(".editar-conteudo")?document.getElementById("nome").value:textoCamelCase(document.getElementById("nome").value);let dataDePostagem;dataDePostagem=""===document.getElementById("data").value?document.querySelector(".editar-conteudo")?"":moment(new Date).format("YYYY-MM-DD[-]"):document.querySelector(".editar-conteudo")?"":`${document.getElementById("data").value}-`,document.getElementById("radio6").checked?(nomeDoArquivo.value=`depoimento_${dataDePostagem}${nomeDoConteudo}.jpg`,nomeDoArquivo.classList.add("ineditavel")):"corpo"!==e.target.value?(nomeDoArquivo.value=`${dataDePostagem}${nomeDoConteudo}${e.target.value}.jpg`,nomeDoArquivo.classList.add("ineditavel")):(nomeDoArquivo.value=`${dataDePostagem}${nomeDoConteudo}{ordem}.jpg`,nomeDoArquivo.classList.remove("ineditavel"))},validarImagens=e=>{let id=e.target.id.split("-")[e.target.id.split("-").length-1];if(!e.target.classList.contains("remover-arquivo")){if(""!==document.getElementById(`tipo-arquivo-${id}`).value)return document.getElementById(`tipo-arquivo-${id}`).value;e.preventDefault(),variaveisGlobais.exibirMensagem("<h3>Você deve escolher o tipo de arquivo antes de selecionar o anexo</h3>",3e3,"Atenção!")}};var inserirContainerDados=(container,id,blocos)=>{let bloco,tipoSessaoEvent=!1,disposicaoImagensEvent=!1;bloco="imagem"===container?blocos.naturezaImagem:"ata"===container?blocos.dadosAtas:blocos.nomeAmigavel,containersDadosArquivos=document.querySelectorAll(`#file-upload-arquivo-${id} .container-dados-arquivo`);for(let i=0;i<containersDadosArquivos.length;i++)containersDadosArquivos[i].outerHTML="";document.getElementById(`arquivo-dados-${id}`).insertAdjacentHTML("beforeend",bloco);let disposicaoImagens=document.querySelectorAll("select[name='disposicaoImagem']");"imagem"===container&&(controlarExibicaoCamposImagem(id),document.getElementById("radio6")&&document.getElementById("radio6").checked&&definirNomeImagem(null,id),disposicaoImagensEvent||(disposicaoImagens[0].addEventListener("change",e=>{definirNomeImagem(e,id)}),disposicaoImagensEvent=!0));let tipoSessao=document.querySelectorAll("select[name='tipoSessao']");"ata"===container&&(tipoSessaoEvent||(tipoSessao[0].addEventListener("change",e=>{}),tipoSessaoEvent=!0)),"diversos"!==container&&document.getElementById(`link-anexo-${id}`)&&(document.getElementById(`link-anexo-${id}`).outerHTML="")};let inserirArquivos=()=>{let arquivoDados=`\n        <div id="file-upload-arquivo-${id}" class="file-upload file-upload-arquivos"> \n            <span class='fechar-janela' data-ref="file-upload-arquivo-${id}">X</span>              \n            <div class="arquivo-dados" id="arquivo-dados-${id}">\n                <div class="tipo-arquivo">\n                    <p>Tipo do documento:</p>\n                    <select name="tipoArquivo" id="tipo-arquivo-${id}" required>\n                        <option disabled selected value="">Selecione o tipo de documento:</option>\n                        <option value="ata">ata</option>\n                        <option value="diversos">diversos</option>                       \n                        <option value="imagem">Imagens de conteúdos (notícias, personagem em foco, fotos usuários)</option>                       \n                    </select>  \n                </div>\n            </div>                \n            <label>\n                <p>Arquivo:</p>\n                <i class="fa fa-info"></i>\n                <span class="dica">Clique no botão de upload abaixo para selecionar o arquivo</span>\n            </label>\n            <div class="anexo">\n                <div class="texto texto-anexo-${id}"></div>\n                <label class="label-upload" for="anexo-${id}" id="label-anexo-${id}">\n                    <i class="fa fa-upload"></i><span class="span-anexar">Anexar Arquivo</span>\n                </label>\n                <input type="file" name="anexo" id="anexo-${id}" class="anexo" required>\n            </div> \n            <i class='fa fa-check anexo-ok'></i>\n        </div>\n    `;document.querySelector(".arquivos-container").insertAdjacentHTML("afterbegin",arquivoDados),setTimeout(()=>{let natureza,inputAnexos=document.querySelectorAll("input[name='anexo']"),removerArquivos=document.querySelectorAll(".label-upload"),removerAnexos=document.querySelectorAll(".fechar-janela"),tipoArquivos=document.querySelectorAll("select[name='tipoArquivo']"),tipoArquivosEvent=!1,removerArquivosEvent=!1,removerAnexosEvent=!1,inputAnexosEvent=!1;document.getElementById("radio6")&&(natureza=document.getElementById("radio6").checked?"depoimentos":"conteudos");let naturezaImagem=`\n            <div class="tipo-imagem container-dados-arquivo">\n                <p class='hidden'>Natureza da imagem:</p>\n                <input name="tipoImagem" id="tipo-imagem-${id}" class='hidden' required value='${natureza}'> \n                <p class='hidden'>Disposição da imagem:</p>\n                <select name="disposicaoImagem" id="disposicao-imagem-${id}" class='hidden'>\n                    <option disabled selected value="">Selecione uma opção:</option>\n                    <option value="">principal</option>\n                    <option value="Sm">card</option>\n                    <option value="XSm">resultados de busca</option>\n                    <option value="Md">destaque (banner)</option>            \n                    <option value="Sq">destaque (quadrada)</option>            \n                    <option value="corpo">corpo do texto</option>            \n                </select>                \n                <label class='label-nome-arquivo-${id}' for="nome-imagem-${id}">\n                    <p>Nome do arquivo:</p>\n                    <i class="fa fa-info"></i>\n                    <span class="dica">Nome do arquivo, igual ao nome da página com a extensão .jpg no final (YYYY-MM-DD-tituloDoConteudo.jpg)</span>\n                </label>\n                <input class='input-nome-arquivo-${id} ineditavel' type="text" name="nomeImagem" id="nome-imagem-${id}" required>\n            </div>`,nomeAmigavel=`\n            <div class="container-dados-arquivo">\n                <label for="nome-amigavel-${id}">\n                    <p>Nome do arquivo:</p>\n                    <i class="fa fa-info"></i>\n                    <span class="dica">Nome a ser exibido na página</span>\n                </label>\n                <input type="text" name="nomeAmigavel" id="nome-amigavel-${id}" required>\n            </div>   \n            <span id='link-anexo-${id}' class='link-anexo'></span>         \n        `,dadosAtas=`\n            <div class="dados-atas container-dados-arquivo">\n            <div>\n                <label for="data-natureza-${id}">\n                    <p>Natureza da sessão:</p>\n                    <i class="fa fa-info"></i>\n                    <span class="dica">Informar se a sseão foi ordinária ou extraordinária</span>\n                </label>\n                <select name="tipoSessao" id="tipo-sessao-${id}" required>\n                    <option disabled selected value="">Selecione uma opção:</option>\n                    <option value="ordinaria">Ordinária</option>\n                    <option value="extraordinaria">Extraordinária</option>                             \n                </select>                \n            </div>\n                <div>\n                    <label for="data-sessao-${id}">\n                        <p>Data da Sessão:</p>\n                        <i class="fa fa-info"></i>\n                        <span class="dica">O dia no qual ocorreu a reunião</span>\n                    </label>\n                    <input type="date" name="dataSessao" id="data-sessao-${id}" required>\n                </div>\n                <div>\n                    <label for="numeroSessao-${id}">\n                        <p>Número da Sessão:</p>\n                        <i class="fa fa-info"></i>\n                        <span class="dica">O número sequencial que consta na ata</span>\n                    </label>\n                    <input type="number" name="numeroSessao" id="numero-sessao-${id}" required>\n                </div>\n            </div>\n        `;for(let i=0;i<inputAnexos.length;i++)inputAnexosEvent||(inputAnexos[i].addEventListener("change",function(e){inputAnexosListener(e)}),inputAnexosEvent=!0),removerAnexosEvent||(removerAnexos[i].addEventListener("click",e=>{removerAnexosListener(e)}),removerAnexosEvent=!0),removerArquivosEvent||(removerArquivos[i].addEventListener("click",e=>{validarImagens(e),removerArquivosListener(e)}),removerArquivosEvent=!0),tipoArquivosEvent||(tipoArquivos[0].addEventListener("change",e=>{let idContainer=e.target.id.split("-")[e.target.id.split("-").length-1];blocos={naturezaImagem,nomeAmigavel,dadosAtas},inserirContainerDados(e.target.value,idContainer,blocos)}),tipoArquivosEvent=!0);id++},40)},rotinasInsercaoLink=e=>{let pagina,id=e.target.id.split("-").pop(),paginaDeEdicao=document.querySelector(".editar-conteudo");if(document.querySelector(`#tipo-arquivo-${id} option[value='diversos']`).selected){document.getElementById(`link-anexo-${id}`)&&(document.getElementById(`link-anexo-${id}`).innerHTML=""),pagina=paginaDeEdicao?document.getElementById("nome").value:textoCamelCase(document.getElementById("nome").value);let path,dataNoticia,dataUpload=moment(new Date).format("YYYY-MM-DD"),nomeAmigavel=textoCamelCase(document.getElementById(`nome-amigavel-${id}`).value),extensao=document.querySelector(`.texto-anexo-${id}`).innerHTML.split(".").pop();document.getElementById("radio0").checked?(path=`/docs/${pagina}/emUso/`,dataNoticia=""):(path="/docs/diversos/emUso/",""===document.getElementById("data").value||paginaDeEdicao?paginaDeEdicao?paginaDeEdicao&&(dataNoticia=""):dataNoticia=`${dataUpload}-`:dataNoticia=`${document.getElementById("data").value}-`);let link=`${path}diversos_${dataNoticia}${pagina}_${dataUpload}_${nomeAmigavel}.${extensao}`;document.getElementById(`link-anexo-${id}`).insertAdjacentHTML("beforeend",link)}},id=0;document.querySelector(".file-upload-problema")&&(document.querySelector(".file-upload-problema").addEventListener("change",function(e){"anexoProblema"===e.target.id&&document.querySelector("#label-anexo-problema i").classList.contains("fa-upload")&&anexos(e,"anexo-problema","inserir")}),document.querySelector(".file-upload-problema").addEventListener("click",function(e){"anexoProblema"===e.target.id&&document.querySelector("#label-anexo-problema i").classList.contains("fa-times")&&anexos(e,"anexo-problema","remover")})),window.addEventListener("DOMContentLoaded",()=>{let idForm;idForm=document.getElementById("enviar-conteudo")?"enviar-conteudo":document.getElementById("inserir-conteudo")?"inserir-conteudo":document.getElementById("form-ds")?"form-ds":document.location.href.split("/").pop(),document.getElementById(idForm).addEventListener("click",e=>{let janelaArquivo;if(e.target.classList.contains("fechar-janela")&&((janelaArquivo=document.getElementById(e.target.dataset.ref)).classList.add("maior2"),setTimeout(function(){janelaArquivo.classList.add("minimiza2"),janelaArquivo.classList.add("opacidade-zero")},300),setTimeout(function(){janelaArquivo.outerHTML=""},600)),e.target.classList.contains("anexo-ok")||e.target.classList.contains("btn-inserir-arquivos")){let inputsContainer,faltaCampo=!1,inputsTodos=document.querySelectorAll(".file-upload-arquivos input[required], .file-upload-arquivos select[required]");document.querySelector(".file-upload-arquivos")&&(e.target.classList.contains("btn-inserir-arquivos")?faltaCampo=variaveisGlobais.checarInputs(inputsTodos):(inputsContainer=document.querySelectorAll(`#${e.target.parentElement.id} input, #${e.target.parentElement.id} select`),faltaCampo=variaveisGlobais.checarInputs(inputsContainer))),faltaCampo||(e.target.classList.contains("anexo-ok")?(e.target.parentElement.classList.toggle("anexo-resumo"),document.getElementById(`label-anexo-${e.target.parentElement.id.split("-").pop()}`).classList.toggle("readonly")):document.querySelector(".file-upload-arquivos")&&e.target.classList.contains("btn-inserir-arquivos")&&document.querySelectorAll(".file-upload-arquivos")[0].classList.add("anexo-resumo"),e.target.classList.contains("btn-inserir-arquivos")&&inserirArquivos())}}),document.querySelector(".arquivos-container").addEventListener("change",function(e){(e.target.classList.contains("anexo")||"nomeAmigavel"===e.target.name)&&rotinasInsercaoLink(e)}),document.getElementById("nome")&&document.getElementById("nome").addEventListener("change",e=>{let links=document.querySelectorAll(".link-anexo");for(let i=0;i<links.length;i++){let nomeVetor=links[i].innerHTML.split("_");nomeNovo=`${nomeVetor[0]}_${textoCamelCase(e.target.value)}_${nomeVetor[2]}_${nomeVetor[3]}`,links[i].innerHTML=nomeNovo}})});